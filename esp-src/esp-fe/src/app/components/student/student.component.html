<div class="holder">
  <ng-container *ngIf="student == null; else loggedIn">
    <div class="sign-in-form">
      <mat-tab-group (selectedIndexChange)="onTabChanged($event)">
        <!-- Sign In Tab -->
        <mat-tab label="Sign In">
          <ng-template mat-tab-label>
            Sign In
          </ng-template>
          <form [formGroup]="signInForm" (ngSubmit)="onSubmit()">
            <div class="form-group">
              <label>Student ID</label>
              <input type="text" formControlName="id" />
              <div *ngIf="signInForm.get('id')?.hasError('required') && signInForm.get('id')?.touched" class="input-error">
                Student ID is required.
              </div>
            </div>

            <div class="form-group">
              <label>Password</label>
              <input type="password" formControlName="password" />
              <div *ngIf="signInForm.get('password')?.hasError('required') && signInForm.get('password')?.touched" class="input-error">
                Password is required.
              </div>
            </div>

            <button mat-raised-button type="submit" [disabled]="signInForm.invalid">Sign In</button>
          </form>
        </mat-tab>

        <!-- Sign Up Tab -->
        <mat-tab label="Sign Up">
          <ng-template mat-tab-label>
            Sign Up
          </ng-template>
          <form [formGroup]="signUpForm" (ngSubmit)="onSignUp()">
            <div class="form-group">
              <label>Student ID</label>
              <input type="text" formControlName="id" />
              <div *ngIf="signUpForm.get('id')?.hasError('required') && signUpForm.get('id')?.touched" class="input-error">
                Student ID is required.
              </div>
            </div>

            <div class="form-group">
              <label>OTP Password</label>
              <input type="password" formControlName="password" />
              <div *ngIf="signUpForm.get('password')?.hasError('required') && signUpForm.get('password')?.touched" class="input-error">
                Password is required.
              </div>
            </div>

            <div class="form-group">
              <label>New Password</label>
              <input type="password" formControlName="newPassword" />
              <div *ngIf="signUpForm.get('newPassword')?.hasError('required') && signUpForm.get('newPassword')?.touched" class="input-error">
                New Password is required.
              </div>
            </div>

            <div class="form-group">
              <label>Confirm Password</label>
              <input type="password" formControlName="confirmNewPassword" />
              <div *ngIf="signUpForm.get('confirmNewPassword')?.hasError('required') && signUpForm.get('confirmNewPassword')?.touched" class="input-error">
                Password Confirmation is required.
              </div>
              <div *ngIf="signUpForm.get('newPassword')?.value !== signUpForm.get('confirmNewPassword')?.value" class="input-error">Passwords do not match.</div>
            </div>

            <div class="form-group">
              <label>Full Name</label>
              <input type="text" formControlName="fullName" />
              <div *ngIf="signUpForm.get('fullName')?.hasError('required') && signUpForm.get('fullName')?.touched" class="input-error">
                Name is required.
              </div>
            </div>

            <div class="form-group">
              <label>SSN</label>
              <input type="text" formControlName="ssn" />
              <div *ngIf="signUpForm.get('ssn')?.hasError('required') && signUpForm.get('ssn')?.touched" class="input-error">
                SSN is required.
              </div>
            </div>

            <div class="form-group">
              <label>Date of Birth</label>
              <input type="date" formControlName="dateOfBirth" />
              <div *ngIf="signUpForm.get('dateOfBirth')?.hasError('required') && signUpForm.get('dateOfBirth')?.touched" class="input-error">
                Date of Birth is required.
              </div>
            </div>

            <div class="form-group">
              <label>Address</label>
              <input type="text" formControlName="address" />
              <div *ngIf="signUpForm.get('address')?.hasError('required') && signUpForm.get('address')?.touched" class="input-error">
                Address is required.
              </div>
            </div>

            <div class="form-group">
              <label>Phone</label>
              <input type="text" formControlName="phone" />
              <div *ngIf="signUpForm.get('phone')?.hasError('required') && signUpForm.get('phone')?.touched" class="input-error">
                Phone is required.
              </div>
            </div>

            <div class="form-group">
              <label>Landline</label>
              <input type="text" formControlName="landline" />
              <div *ngIf="signUpForm.get('landline')?.hasError('required') && signUpForm.get('landline')?.touched" class="input-error">
                Landline is required.
              </div>
            </div>

            <div class="form-group">
              <label>Email Address</label>
              <input type="email" formControlName="email" />
              <div *ngIf="signUpForm.get('email')?.hasError('required') && signUpForm.get('email')?.touched" class="input-error">
                Email is required.
              </div>
              <div *ngIf="signUpForm.get('email')?.hasError('email') && signUpForm.get('email')?.touched" class="input-error">
                Please enter a valid email address.
              </div>
            </div>

            <div class="form-group">
              <label for="gender">Gender</label>
              <select formControlName="gender" id="gender">
                <option value="male">Male</option>
                <option value="female">Female</option>
              </select>
              <div *ngIf="signUpForm.get('gender')?.hasError('required') && signUpForm.get('gender')?.touched" class="input-error">
                Gender is required.
              </div>
            </div>

            <button mat-raised-button type="submit" [disabled]="signUpForm.invalid">Sign Up</button>
          </form>
        </mat-tab>
      </mat-tab-group>
    </div>
  </ng-container>

  <ng-template #loggedIn>

    <div class="student-main-page">

      <div class="header">
        <h1>Student Dashboard</h1>
      </div>

      <div class="sidebar">
        <ul class="nav-links">
          <li><a (click)="selectSection(0)">Student Home Page</a></li>
          <li><a (click)="selectSection(1)">Enroll in Courses</a></li>
          <li><a (click)="selectSection(2)">Withdraw from Courses</a></li>
          <!-- Add more navigation links as needed -->
        </ul>
      </div>

      <div class="main-content">

        <ng-container *ngIf="selectedSection == 0">
          This is the student home page!
        </ng-container>

        <ng-container *ngIf="selectedSection == 1">
          <div class="course-list">
            <div *ngFor="let course of courses" class="course-card">
              <div class="course-details">
                <h3>{{ course.courseName }}</h3>
                <p>Code: {{ course.courseCode }}</p>
                <p>Credit Hours: {{ course.creditHrs }}</p>
                <p>Description: {{ truncateDescription(course.courseDescription, 80) }}</p>
              </div>
              <div class="action-buttons">
                <button *ngIf="!isEnrolled(course)" (click)="enroll(course)">Add</button>
                <button *ngIf="isEnrolled(course)" (click)="unEnroll(course)">Remove</button>
              </div>
            </div>
          </div>
          <div class="remaining-credit-hours">
            Remaining Credit Hours: {{ totalAvailableCreditHours }}
          </div>
          <button class="register-courses-button" (click)="registerCourses()">Register Courses</button>
        </ng-container>

        <ng-container *ngIf="selectedSection == 2">
          <div>

            <div class="course-list-container">
              <div *ngFor="let course of registeredCourses;" class="withdraw-course-item">
                  <div class="withdraw-course-name">{{ course.courseName }}</div>
                  <div class="withdraw-course-code">{{ course.courseCode }}</div>
                  <div class="withdraw-course-description">{{ course.courseDescription }}</div>
                  <div>
                    <button class="select-withdraw-button" *ngIf="!isSelectedToWithdraw(course)" (click)="selectToWithdraw(course)">Select</button>
                    <button class ="deselect-withdraw-button" *ngIf="isSelectedToWithdraw(course)" (click)="deselectFromWithdrawn(course)">Deselect</button>
                  </div>
              </div>
            </div>
            <div class="confirm-withdraw" *ngIf="this.registeredCourses.length != 0">
              <button (click)="withdrawCourses(withdrawnCourses)"> WITHDRAW SELECTED COURSES</button>
            </div>
            <div *ngIf="this.registeredCourses.length == 0">
              <label>There are no registered courses to withdraw.</label>
            </div>
          </div>
        </ng-container>

      </div>

    </div>

  </ng-template>

</div>
